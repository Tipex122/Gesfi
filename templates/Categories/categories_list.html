{% extends "base.html" %}
{% load mptt_tags %}

{% block title %}Categories{% endblock %}

{% block heading %}
    <h2>Categories</h2>
{% endblock %}

{% block content %}

        <!-- XLH -->

        <div id="test_jstree1"  class="list-group">
            <!-- in this example the tree is populated from inline HTML -->
            <ul>
              <li>Root node 1
                <ul>
                  <li id="child_node_1">Child node 1</li>
                  <li><a href="#">Child node 2</a></li>
                  <li>Child node 2</li>
                </ul>
              </li>
              <li>Root node 2</li>
            </ul>
        </div>

        <script>
            $('#test_jstree1').jstree({
                "core" : {
                   "themes" : {
                        //"variant" : "large"
                        }
                      },
                  "checkbox" : {
                         "keep_selected_style" : false},
                        "plugins" : [ "wholerow", "checkbox" ]
                });


        </script>

        <div id="jstree2" class="list-group">

            <!--
            <ul>
                {% recursetree categories %}
                    <li>
                        {{ node.name }}{{ node.amount }}
                        {% if not node.is_leaf_node %}
                            <ul>
                                {{ children }}
                            </ul>
                        {% endif %}
                    </li>
                {% endrecursetree %}
            </ul>
            -->
        </div>

        <script>

        var nodedata = {
            "data": {
                {% recursetree categories %}
                    "data": "{{ node.name }}",
                    "id": "{{ node.id }}",
                    "state":"open",
                    "children": [{ {{ children }} }],
                {% endrecursetree %}
            }
        };


        $('#jstree2').jstree({
            "data" :
                {
                  "model": "categories.category",
                  "pk": 37,
                  "fields": {
                    "name": "D\u00e9penses",
                    "description": "",
                    "amount": "1750.00",
                    "parent": null,
                    "lft": 1,
                    "rght": 8,
                    "tree_id": 1,
                    "level": 0
                  }
                },
                {
                  "model": "categories.category",
                  "pk": 38,
                  "fields": {
                    "name": "Revenus",
                    "description": "",
                    "amount": "11300.00",
                    "parent": null,
                    "lft": 1,
                    "rght": 14,
                    "tree_id": 2,
                    "level": 0
                  }
                },
                {
                  "model": "categories.category",
                  "pk": 40,
                  "fields": {
                    "name": "Assurance",
                    "description": "",
                    "amount": "50.00",
                    "parent": 37,
                    "lft": 2,
                    "rght": 3,
                    "tree_id": 1,
                    "level": 1
                  }
                },
                {
                  "model": "categories.category",
                  "pk": 45,
                  "fields": {
                    "name": "V\u00e9hicules",
                    "description": "",
                    "amount": "500.00",
                    "parent": 37,
                    "lft": 6,
                    "rght": 7,
                    "tree_id": 1,
                    "level": 1
                  }
                },
                {
                  "model": "categories.category",
                  "pk": 46,
                  "fields": {
                    "name": "Salaires",
                    "description": "",
                    "amount": "10500.00",
                    "parent": 38,
                    "lft": 8,
                    "rght": 13,
                    "tree_id": 2,
                    "level": 1
                  }
                },
                {
                  "model": "categories.category",
                  "pk": 47,
                  "fields": {
                    "name": "Patricia",
                    "description": "",
                    "amount": "2500.00",
                    "parent": 46,
                    "lft": 9,
                    "rght": 10,
                    "tree_id": 2,
                    "level": 2
                  }
                },
                {
                  "model": "categories.category",
                  "pk": 48,
                  "fields": {
                    "name": "Xavier",
                    "description": "",
                    "amount": "8000.00",
                    "parent": 46,
                    "lft": 11,
                    "rght": 12,
                    "tree_id": 2,
                    "level": 2
                  }
                },
                {
                  "model": "categories.category",
                  "pk": 49,
                  "fields": {
                    "name": "Locations",
                    "description": "",
                    "amount": "800.00",
                    "parent": 38,
                    "lft": 2,
                    "rght": 7,
                    "tree_id": 2,
                    "level": 1
                  }
                },
                {
                  "model": "categories.category",
                  "pk": 50,
                  "fields": {
                    "name": "Appartementt N\u00b01",
                    "description": "",
                    "amount": "455.00",
                    "parent": 49,
                    "lft": 5,
                    "rght": 6,
                    "tree_id": 2,
                    "level": 2
                  }
                },
                {
                  "model": "categories.category",
                  "pk": 51,
                  "fields": {
                    "name": "Appartement N\u00b02",
                    "description": "",
                    "amount": "345.00",
                    "parent": 49,
                    "lft": 3,
                    "rght": 4,
                    "tree_id": 2,
                    "level": 2
                  }
                },
                {
                  "model": "categories.category",
                  "pk": 52,
                  "fields": {
                    "name": "Maison",
                    "description": "",
                    "amount": "1200.00",
                    "parent": 37,
                    "lft": 4,
                    "rght": 5,
                    "tree_id": 1,
                    "level": 1
                  }
                }


            });

        </script>


        <div id="mainTree" class="list-group">
            <h2>Maintree</h2>
            <hr>
        </div>

        <script>
            $('#mainTree').jstree({
                    'core': {

                    'data': [
                            { "id": "ajson1", "parent": "#", "text": "Simple root node" },
                            { "id": "ajson2", "parent": "#", "text": "Root node 2" },
                            { "id": "ajson3", "parent": "ajson2", "text": "Child 1" },
                            { "id": "ajson4", "parent": "ajson2", "text": "Child 2" }
                        ]
                    }
                });
        </script>


        <div id="using_json1">
            <h2>using_json1</h2>
            <!-- <h1>{{jsondata}}</h1> -->
        </div>


        <script>
            $('#using_json1').jstree({
                'core': {
                    'data' : {{jsondata}}
                }
             });

        </script>

        <div id="using_json2">
             <h2>using_json2</h2>
        </div>

        <script>

            var data =
            [
                {
                    "model": "categories.category",
                    "pk": 37,
                    "fields": {
                        "name": "D\u00e9penses",
                        "description": "",
                        "amount": "1760.00",
                        "parent": 53,
                        "lft": 2,
                        "rght": 9,
                        "tree_id": 1,
                        "level": 1
                    }
                },
                {
                    "model": "categories.category",
                    "pk": 38,
                    "fields": {
                        "name": "Revenus",
                        "description": "",
                        "amount": "11351.00",
                        "parent": 53,
                        "lft": 10,
                        "rght": 23,
                        "tree_id": 1,
                        "level": 1
                    }
                },
                {
                    "model": "categories.category",
                    "pk": 40,
                    "fields": {
                        "name": "Assurance",
                        "description": "",
                        "amount": "50.00",
                        "parent": 37,
                        "lft": 3,
                        "rght": 4,
                        "tree_id": 1,
                        "level": 2
                    }
                },
                {
                    "model": "categories.category",
                    "pk": 45,
                    "fields": {
                        "name": "V\u00e9hicules",
                        "description": "",
                        "amount": "510.00",
                        "parent": 37,
                        "lft": 7,
                        "rght": 8,
                        "tree_id": 1,
                        "level": 2
                    }
                },
                {
                    "model": "categories.category",
                    "pk": 46,
                    "fields": {
                        "name": "Salaires",
                        "description": "",
                        "amount": "10550.00",
                        "parent": 38,
                        "lft": 17,
                        "rght": 22,
                        "tree_id": 1,
                        "level": 2
                    }
                },
                {
                    "model": "categories.category",
                    "pk": 47,
                    "fields": {
                        "name": "Patricia",
                        "description": "",
                        "amount": "2500.00",
                        "parent": 46,
                        "lft": 18,
                        "rght": 19,
                        "tree_id": 1,
                        "level": 3
                    }
                },
                {
                    "model": "categories.category",
                    "pk": 48,
                    "fields": {
                        "name": "Xavier",
                        "description": "",
                        "amount": "8050.00",
                        "parent": 46,
                        "lft": 20,
                        "rght": 21,
                        "tree_id": 1,
                        "level": 3
                    }
                },
                {
                    "model": "categories.category",
                    "pk": 49,
                    "fields": {
                        "name": "Locations",
                        "description": "",
                        "amount": "801.00",
                        "parent": 38,
                        "lft": 11,
                        "rght": 16,
                        "tree_id": 1,
                        "level": 2
                    }
                },
                {
                    "model": "categories.category",
                    "pk": 50,
                    "fields": {
                        "name": "Appartementt N\u00b01",
                        "description": "",
                        "amount": "456.00",
                        "parent": 49,
                        "lft": 14,
                        "rght": 15,
                        "tree_id": 1,
                        "level": 3
                    }
                },
                {
                    "model": "categories.category",
                    "pk": 51,
                    "fields": {
                        "name": "Appartement N\u00b02",
                        "description": "",
                        "amount": "345.00",
                        "parent": 49,
                        "lft": 12,
                        "rght": 13,
                        "tree_id": 1,
                        "level": 3
                    }
                },
                {
                    "model": "categories.category",
                    "pk": 52,
                    "fields": {
                        "name": "Maison",
                        "description": "",
                        "amount": "1200.00",
                        "parent": 37,
                        "lft": 5,
                        "rght": 6,
                        "tree_id": 1,
                        "level": 2
                    }
                },
                {
                    "model": "categories.category",
                    "pk": 53,
                    "fields": {
                        "name": "Budget",
                        "description": "",
                        "amount": "13111.00",
                        "parent": null,
                        "lft": 1,
                        "rght": 24,
                        "tree_id": 1,
                        "level": 0
                    }
                }
            ];


            $('#using_json2').jstree({
                plugins: ['themes', 'json_data', 'checkbox',"types"],
                    json_data: {data: data},
                    themes: {
                            theme: 'default'
                     },
                    checkbox: {
                            real_checkboxes: true,
                            two_state: true
                    },
                    types:{
                            "types":{
                                "disabled" : {
                                    "check_node" : false,
                                    "uncheck_node" : false
                                   } ,
                            "directory" : {
                                "check_node" : false,
                                "uncheck_node" : false
                            }
                        }
                }
             });
        </script>


        <div id="using_json3">
            <h2>using_json3</h2>
        </div>




        <!-- XLH -->

 <!-- XLH -->
    <div class="list-group">
    <ul class="list-unstyled">
        {% recursetree categories %}
            <li class="well well-sm">
                <span>{{ node.name }}<span><span>{{ node.amount }}</span>
                {% if not node.is_leaf_node %}
                    <ul>
                        {{ children }}
                    </ul>
                {% endif %}
            </li>
        {% endrecursetree %}
    </ul>
    </div>

    <div class="list-group">
    <ul class="list-group">
        {% recursetree categories %}
            <li class="list-group-item">
                <div>{{ node.name }}</div><div>{{ node.amount }}</div>

                {% if not node.is_leaf_node %}
                    <ul class="list-group-item">
                        {{ children }}
                    </ul>
                {% endif %}
            </li>

        {% endrecursetree %}
    </ul>
    </div>

    <div class="list-group">
    <table class="table table-striped">
        <thead>
            <tr>
                <th>##</th>
                <th>Category</th>
                <th>Parent's category</th>
                <th>Amount</th>
            </tr>
        </thead>
        <tbody>
        {% recursetree categories %}
            <tr>
                <td></td>
                <td>{{ node.name }}</td><td> {{ node.amount }}</td>
                {% if not node.is_leaf_node %}
                    <td></td>
                    <td>
                        {{ children }}
                    </td>
                {% endif %}
            </tr>
        {% endrecursetree %}
        </tbody>
    </table>
    </div>

    <div class="list-group">
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>##</th>
                    <th>Category</th>
                    <th>Parent's category</th>
                    <th>Amount</th>
                </tr>
            </thead>
            <tbody>

                    {% recursetree categories %}
                        <tr>

                            <td>##</td> <td>{{ node.name }}</td> <td> {{node.parent}}</td> <td> {{ node.amount }}</td>
                            {% if not node.is_leaf_node %}

                                <td class="children">
                                    {{ children }}
                                </td>

                            {% endif %}

                        </tr>
                    {% endrecursetree %}

                <tr>
                    <td>01</td>
                    <td>Mark</td>
                    <td>Otto</td>
                    <td>@mdo</td>
                </tr>
                <tr>
                    <td>02</td>
                    <td>Jacob</td>
                    <td>Thornton</td>
                    <td>@fat</td>
                </tr>
                <tr>
                    <td>03</td>
                    <td>Larry</td>
                    <td>the Bird</td>
                    <td>@twitter</td>
                </tr>
            </tbody>
        </table>
    </div>

{% endblock %}